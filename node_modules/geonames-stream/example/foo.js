var geonames = require('../'),
    request = require('request'),
    split = require('split');

function test(url, callback) {
  var count = 0;
  request.get( url ).
    pipe(geonames.unzip()).
    pipe(split()).
    pipe(geonames.parser()).
    pipe(geonames.modifiers()).
    on('end', function(){
      callback(count);
    }).
    on('data',function(d){ ++count; });
}

test('http://download.geonames.org/export/dump/NZ.zip', function(count) {
  console.log("end NZ: " + count);
  test('http://download.geonames.org/export/dump/PL.zip', console.log);
});